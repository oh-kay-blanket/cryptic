@use "../../base/var" as *;

.keyboard {
  width: 100%;
  height: $lc-keyboard-height;
  // Use safe area inset for devices with home indicators (notched iPhones)
  // Falls back to 0 on devices without safe areas
  padding: 0 0 env(safe-area-inset-bottom, 0);
  text-align: center;
  align-self: flex-end;

  // Desktop: add bottom margin
  @media (min-width: 768px) {
    margin-bottom: 0.5rem;
  }

  .k-row {
    display: flex;
    justify-content: center;
    margin: 0.25rem 0;

    @media (min-width: 768px) {
      margin: 0.35rem 0;
    }

    // Last row needs bottom margin on desktop
    &:last-child {
      @media (min-width: 768px) {
        margin-bottom: 1rem;
      }
    }

    button {
      position: relative;
      // background-color handled by Tailwind classes in React component
      border: none;
      // Disable tap highlight on touch devices
      -webkit-tap-highlight-color: transparent;
      // Width calculated so 10 keys (row 1) fill the screen
      // 10 keys * 2 margins * 0.125rem = 2.5rem + 0.5rem padding = 3rem
      width: calc((100% - 2.5rem) / 10);
      height: 52px;
      border-radius: 8px;
      margin: 0 0.125rem;
      padding: 0;

      // Only apply hover styles on devices that support hover (not touch)
      @media (hover: hover) {
        &:hover {
          background-color: rgb(163 163 163); // neutral-400
        }

        html.dark &:hover {
          background-color: rgb(115 115 115) !important; // neutral-500
        }
      }

      @media (max-height: 600px) {
        height: 42px;
      }

      // Larger keys on desktop with enough space
      @media (min-width: 768px) and (min-height: 900px) {
        width: 50px;
        height: 68px;
        margin: 0 0.25rem;
        font-size: 1.15rem;
      }

      // Standard desktop keys
      @media (min-width: 768px) and (max-height: 899px) and (min-height: 700px) {
        width: 46px;
        height: 64px;
        margin: 0 0.2rem;
        font-size: 1.1rem;
      }

      &#backspace {
        // 1.5x the standard key width on mobile
        width: calc((100% - 3rem) / 10 * 1.5);
        // background-color handled by Tailwind classes in React component

        @media (min-width: 768px) and (min-height: 900px) {
          width: 72px;
        }

        @media (min-width: 768px) and (max-height: 899px) and (min-height: 700px) {
          width: 66px;
        }
      }

      &#enter-key {
        // 1.5x the standard key width on mobile
        width: calc((100% - 3rem) / 10 * 1.5);
        font-size: 0.75rem;
        font-weight: 600;
        // background-color handled by Tailwind classes in React component

        @media (min-width: 768px) and (min-height: 900px) {
          width: 72px;
          font-size: 0.9rem;
        }

        @media (min-width: 768px) and (max-height: 899px) and (min-height: 700px) {
          width: 66px;
          font-size: 0.85rem;
        }

        // Only apply hover styles on devices that support hover (not touch)
        @media (hover: hover) {
          &:hover:not(.cursor-default) {
            background-color: #f5c1a1;
          }

          html.dark &:hover:not(.cursor-default) {
            background-color: rgb(110, 65, 42) !important;
          }
        }
      }

      span,
      img {
        position: absolute;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
        display: block;
      }
    }
  }
}

// Compact keyboard for constrained heights on wider screens
@media (min-width: 768px) and (max-height: 700px) and (min-height: 500px) {
  .keyboard {
    .k-row {
      margin: 0.2rem 0;

      button {
        width: 38px;
        height: 44px;
        font-size: 0.95rem;
      }

      button#backspace,
      button#enter-key {
        width: 56px;
      }
    }
  }
}

// Hide keyboard only on very constrained heights where it truly won't fit
@media (min-width: 768px) and (max-height: 499px) {
  .keyboard {
    display: none;
  }
}
