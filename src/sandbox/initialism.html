<!DOCTYPE html>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
</head>

<body>
	<div class="container">
		<div class="w2"><span class="letter">T</span><span class="letter">u</span><span class="letter">c</span><span class="letter">s</span><span class="letter">o</span><span class="letter">n</span></div>
	
		<div class="w1">Arizona boomer starts to <span class="letter">t</span>alk <span class="letter">u</span>p <span class="letter">c</span>ity <span class="letter">s</span>ituated <span class="letter">o</span>ver <span class="letter">N</span>ogales</div>
		
		<button class="show-btn">Solve</button>
	</div>
</body>


<style>
html, body {
    height: 100%;
	font-size: 18px;
}

body {
    display: flex;
	font-family:Georgia, 'Times New Roman', Times, serif
}

.container {
    display: flex;
    flex: 0 0 auto;
    flex-direction: column;
	justify-content: center;
    align-self: center;
    max-width: 800px;
    height: 500px;
    margin: 0 auto;
    text-align: center;
}

.show-btn {
    outline: none;
    width: calc(100% + 4px);
    border: none;
    padding: 4px;
    margin: 20px -2px;
    cursor: pointer;
	border-radius: 50px;
}

.w1, .w2 {
    position: relative;
	min-height: 50px;
}

.letter {
    z-index: 10;
}

.w2 .letter {
	color: transparent;
	text-transform: uppercase;
}

.disabled {
    cursor: default;
}

</style>

<script>

	// // containers
	const wordContainer1 = $(`.w1`);
	const wordContainer2 = $(`.w2`);

	// // button
	const showBtn = $('.show-btn');

	// find object function
	function findObjectInArray(array, key, val) {
		for(let i = 0; i < array.length; i++)
			if(array[i][key].toLowerCase() === val.toLowerCase())
				return i;
		return null;
	}

	// animate function
	function animate(elem, options, duration = 500) {
		let first = Object.assign({}, options);
		first.top *= rand(100, 103) / 100;
		first.left *= rand(100, 103) / 100;
		elem.animate(first, duration, function() {
			elem.animate(options, duration / 1.5)
		});
	}
	
	// random function
	function rand(min = 0, max = 100) {
		return Math.floor(Math.random() * (max - min)) + min;
	}

	// rearrange function
	function rearrange(w1, w2) {

		// hide button
		showBtn.addClass('disabled').animate({
			opacity: 0
		}, 300);
		
		// set up position arrays
		let p1 = [];
		let p2 = [];
		
		// get y diff (when all on same line)
		const yDiff = w2.position().top - w1.position().top;
		console.log(yDiff);
		
		// populate p1 array
		for(let letter of w1.children()) {
			if(!letter.textContent.trim())
				continue;
			letter = $(letter);

			
			p1.push(Object.assign({}, letter.position(), {
				name: letter.text(),
				element: letter
			}));
		}
		console.log(p1);

		// populate p2 array
		for(let letter of w2.children()) {
			letter = $(letter);
			p2.push(Object.assign({}, letter.position(), {
				name: letter.text(),
				element: letter
			}));
		}

		// set w1 realtive and fixed height
		w1.css({
			position: 'relative',
			height: w1.height()
		});

		// set p1 letters absolute and to current position
		for(letter of p1) {
			letter.element.css({
				position: 'absolute',
				left: letter.left,
				top: letter.top
			});
		}
		
		// animate p1 letters to p2 positions
		for(const l1 of p1) {
			const l2Index = findObjectInArray(p2, 'name', l1.name);
			const l2 = p2.splice(l2Index, 1)[0];
			// console.log(l2)
			setTimeout(
				animate.bind(null, l1.element, {
					top: l2.top + yDiff,
					left: l2.left
				}),
				rand(100, 1000)
			);
		}
	}

	showBtn.on('click', rearrange.bind(null, wordContainer1, wordContainer2));
</script>